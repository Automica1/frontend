(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2150],{7346:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},8900:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},12086:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},19258:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},20138:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},40553:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},40684:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},43074:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},45836:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},47190:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},51252:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},58227:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},59390:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});class r{async getAuthToken(){if(this.authToken&&this.tokenExpiry&&Date.now()<this.tokenExpiry-3e5)return this.authToken;try{let e=await fetch("/api/auth",{credentials:"include"});if(!e.ok)throw Error("Auth failed: ".concat(e.status));let{accessToken:t,expiresIn:s}=await e.json();return this.authToken=t,this.tokenExpiry=Date.now()+1e3*s,t}catch(e){throw this.clearAuth(),Error("Authentication failed. Please log in again.")}}clearAuth(){this.authToken=null,this.tokenExpiry=null}buildQueryString(e){let t=Object.entries(e).filter(e=>{let[t,s]=e;return null!=s&&""!==s});if(0===t.length)return"";let s=t.map(e=>{let[t,s]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(s))}).join("&");return"?".concat(s)}async makeAuthenticatedRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await this.getAuthToken(),r=await fetch("".concat(this.baseUrl).concat(e),{...t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s),...t.headers}});if(!r.ok){if(401===r.status)throw this.clearAuth(),Error("Authentication expired. Please log in again.");let e=await r.text();throw Error("API Error (".concat(r.status,"): ").concat(e))}return r.json()}async generateToken(e,t){return this.makeAuthenticatedRequest("/tokens/generate",{method:"POST",body:JSON.stringify({credits:e,description:t})})}async deleteToken(e){return this.makeAuthenticatedRequest("/tokens/".concat(e),{method:"DELETE"})}async getMyTokens(){return this.makeAuthenticatedRequest("/tokens/my-tokens")}async getAllTokens(){return this.makeAuthenticatedRequest("/tokens/all")}async getUsedTokens(){return this.makeAuthenticatedRequest("/tokens/used")}async getUnusedTokens(){return this.makeAuthenticatedRequest("/tokens/unused")}async getAllUsers(){return this.makeAuthenticatedRequest("/admin/users")}async getUserById(e){return this.makeAuthenticatedRequest("/admin/users/".concat(e))}async getUserStats(){return this.makeAuthenticatedRequest("/admin/users/stats")}async getUserActivity(e){return this.makeAuthenticatedRequest("/admin/users/".concat(e,"/activity"))}async getUserCredits(e){return this.makeAuthenticatedRequest("/admin/users/".concat(e,"/credits"))}async getGlobalUsageStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest("/admin/usage/global".concat(t))}async getUserUsageStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest("/admin/usage/users".concat(t))}async getServiceUserStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest("/admin/usage/services".concat(t))}async getUserUsageHistory(e,t){let s=t?this.buildQueryString(t):"";return this.makeAuthenticatedRequest("/admin/usage/user/".concat(e,"/history").concat(s))}async getServiceUsageHistory(e,t){let s=t?this.buildQueryString(t):"";return this.makeAuthenticatedRequest("/admin/usage/service/".concat(e,"/history").concat(s))}isAuthenticated(){return!!(this.authToken&&this.tokenExpiry&&Date.now()<this.tokenExpiry)}getTokenExpiry(){return this.tokenExpiry}refreshAuth(){this.clearAuth()}async getTokenStats(){try{let[e,t,s,r]=await Promise.all([this.getAllTokens(),this.getUsedTokens(),this.getUnusedTokens(),this.getMyTokens()]);return{total:e.count||e.tokens.length,used:t.count||t.tokens.length,unused:s.count||s.tokens.length,myTokens:r.count||r.tokens.length}}catch(e){throw Error("Failed to fetch token statistics: ".concat(e))}}async getDashboardStats(){try{let[e,t]=await Promise.all([this.getTokenStats(),this.getUserStats()]);return{tokenStats:e,userStats:t.stats}}catch(e){throw Error("Failed to fetch dashboard statistics: ".concat(e))}}async getUsageAnalytics(e){try{let[t,s,r]=await Promise.all([this.getGlobalUsageStats(e),this.getUserUsageStats(e),this.getServiceUserStats(e)]);return{globalStats:t,userStats:s,serviceStats:r}}catch(e){throw Error("Failed to fetch usage analytics: ".concat(e))}}async getTopServicesByUsage(e){try{return(await this.getGlobalUsageStats(e)).stats.sort((e,t)=>t.total_calls-e.total_calls)}catch(e){throw Error("Failed to fetch top services: ".concat(e))}}async getTopUsersByUsage(e){try{return(await this.getUserUsageStats(e)).stats.sort((e,t)=>t.total_calls-e.total_calls)}catch(e){throw Error("Failed to fetch top users: ".concat(e))}}isValidTokenFormat(e){return/^TK_[a-zA-Z0-9]{33}$/.test(e)}formatTokenForDisplay(e){return!e||e.length<10?e:"".concat(e.substring(0,8),"...").concat(e.substring(e.length-6))}getDaysUntilExpiry(e){let t=new Date(e),s=new Date;return Math.ceil((t.getTime()-s.getTime())/864e5)}isTokenExpired(e){return new Date(e)<new Date}formatUserRole(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}isUserRecentlyActive(e){return!!e&&new Date(e)>new Date(Date.now()-2592e6)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatDateForQuery(e){return e.toISOString().split("T")[0]}calculateSuccessRate(e,t){return 0===t?0:Math.round(e/t*1e4)/100}formatServiceName(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}getDateRangePresets(){let e=new Date,t=this.formatDateForQuery(e),s=new Date(e);s.setDate(s.getDate()-1);let r=new Date(e);r.setDate(r.getDate()-7);let a=new Date(e);a.setDate(a.getDate()-30);let n=new Date(e.getFullYear(),e.getMonth(),1),i=new Date(e.getFullYear(),e.getMonth()-1,1),l=new Date(e.getFullYear(),e.getMonth(),0);return{today:{start_date:t,end_date:t},yesterday:{start_date:this.formatDateForQuery(s),end_date:this.formatDateForQuery(s)},last7Days:{start_date:this.formatDateForQuery(r),end_date:t},last30Days:{start_date:this.formatDateForQuery(a),end_date:t},thisMonth:{start_date:this.formatDateForQuery(n),end_date:t},lastMonth:{start_date:this.formatDateForQuery(i),end_date:this.formatDateForQuery(l)}}}constructor(){this.authToken=null,this.tokenExpiry=null,this.baseUrl="https://dev.automica.ai/go/api/v1"}}let a=new r},72786:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},76218:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>L});var r=s(72311),a=s(62847),n=s(7346),i=s(20138),l=s(12086);function c(e){let{searchTerm:t,setSearchTerm:s,filterStatus:a,setFilterStatus:n,sortBy:i,setSortBy:c,sortOrder:o,setSortOrder:d}=e,x=e=>{let[t,s]=e.split("-");c(t),d(s)};return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search tokens...",value:t,onChange:e=>s(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full sm:w-64"})]}),(0,r.jsxs)("select",{value:a,onChange:e=>n(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Tokens"}),(0,r.jsx)("option",{value:"my-tokens",children:"My Tokens"}),(0,r.jsx)("option",{value:"used",children:"Used Only"}),(0,r.jsx)("option",{value:"unused",children:"Unused Only"})]}),(0,r.jsxs)("select",{value:"".concat(i,"-").concat(o),onChange:e=>x(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"createdAt-desc",children:"Newest First"}),(0,r.jsx)("option",{value:"createdAt-asc",children:"Oldest First"}),(0,r.jsx)("option",{value:"credits-desc",children:"Highest Credits"}),(0,r.jsx)("option",{value:"credits-asc",children:"Lowest Credits"}),(0,r.jsx)("option",{value:"expiresAt-asc",children:"Expiring Soon"}),(0,r.jsx)("option",{value:"expiresAt-desc",children:"Expiring Later"})]})]})}function o(e){let{searchTerm:t,setSearchTerm:s,filterStatus:a,setFilterStatus:l,sortBy:o,setSortBy:d,sortOrder:x,setSortOrder:u,onExport:m,onGenerateToken:h}=e;return(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,r.jsx)(c,{searchTerm:t,setSearchTerm:s,filterStatus:a,setFilterStatus:l,sortBy:o,setSortBy:d,sortOrder:x,setSortOrder:u}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,r.jsx)(n.A,{className:"w-4 h-4"}),"Export"]}),(0,r.jsxs)("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(i.A,{className:"w-4 h-4"}),"Generate Token"]})]})]})})}var d=s(45836),x=s(8900),u=s(51252),m=s(43074),h=s(89447),g=s(40684);function y(e){let{title:t,value:s,icon:a,color:n}=e;return(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:t}),(0,r.jsx)("p",{className:"text-2xl font-bold ".concat({blue:"text-gray-900",green:"text-green-600",orange:"text-orange-600",purple:"text-purple-600",red:"text-red-600"}[n]),children:"number"==typeof s?s.toLocaleString():s})]}),(0,r.jsx)("div",{className:{blue:"text-blue-500",green:"text-green-500",orange:"text-orange-500",purple:"text-purple-500",red:"text-red-500"}[n],children:a})]})})}function p(e){let{stats:t}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8",children:[(0,r.jsx)(y,{title:"Total Tokens",value:t.total,icon:(0,r.jsx)(d.A,{className:"w-8 h-8"}),color:"blue"}),(0,r.jsx)(y,{title:"Used Tokens",value:t.used,icon:(0,r.jsx)(x.A,{className:"w-8 h-8"}),color:"green"}),(0,r.jsx)(y,{title:"Unused Tokens",value:t.unused,icon:(0,r.jsx)(u.A,{className:"w-8 h-8"}),color:"orange"}),(0,r.jsx)(y,{title:"Total Credits",value:t.totalCredits,icon:(0,r.jsx)(m.A,{className:"w-8 h-8"}),color:"purple"}),(0,r.jsx)(y,{title:"Used Credits",value:t.usedCredits,icon:(0,r.jsx)(h.A,{className:"w-8 h-8"}),color:"red"}),(0,r.jsx)(y,{title:"Available Credits",value:t.availableCredits,icon:(0,r.jsx)(g.A,{className:"w-8 h-8"}),color:"green"})]})}let b=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}),f=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});function j(e){let{token:t,onViewDetails:s,onDeleteToken:a,isDeleting:n,formatTokenForDisplay:i,formatDate:l,getDaysUntilExpiry:c,isTokenExpired:o}=e,d=o(t.expiresAt),x=c(t.expiresAt);return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(n?"opacity-50":""),children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)("div",{className:"font-mono text-gray-900 bg-gray-100 px-2 py-1 rounded",children:i(t.token)})})})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.credits.toLocaleString()})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.isUsed?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Used"}):d?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Expired"}):(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Active"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-900",children:l(t.createdAt)}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["by ",t.createdBy]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:d?(0,r.jsx)("span",{className:"text-red-600 font-medium",children:"Expired"}):x<=7?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-orange-600 font-medium",children:l(t.expiresAt)}),(0,r.jsxs)("div",{className:"text-xs text-orange-500",children:[x," days left"]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-900",children:l(t.expiresAt)}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[x," days left"]})]})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:t.description,children:t.description||"No description"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>s(t),disabled:n,className:"text-blue-600 hover:text-blue-900 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",title:"View Details",children:(0,r.jsx)(b,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>a(t),disabled:n,className:"text-red-600 hover:text-red-900 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",title:n?"Deleting...":"Delete Token",children:n?(0,r.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-red-600 border-t-transparent"}):(0,r.jsx)(f,{className:"h-5 w-5"})})]})})]})}function k(e){let{hasFilters:t}=e;return(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(d.A,{className:"mx-auto w-12 h-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No tokens found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:t?"Try adjusting your search or filter criteria.":"Get started by creating your first token."})]})}var w=s(59390);function v(e){let{tokens:t,onViewDetails:s,onTokenDeleted:n,formatTokenForDisplay:i,formatDate:l,getDaysUntilExpiry:c,isTokenExpired:o,hasFilters:d}=e,[x,u]=(0,a.useState)(new Set),m=async e=>{if(window.confirm("Are you sure you want to delete this token?\n\nToken: ".concat(i(e.token),"\nCredits: ").concat(e.credits,"\nDescription: ").concat(e.description,"\n\nThis action cannot be undone.")))try{u(t=>new Set([...t,e.id])),await w.K.deleteToken(e.id),u(t=>{let s=new Set(t);return s.delete(e.id),s}),n()}catch(s){u(t=>{let s=new Set(t);return s.delete(e.id),s});let t=s instanceof Error?s.message:"Failed to delete token";alert("Error deleting token: ".concat(t)),console.error("Error deleting token:",s)}};return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Token"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credits"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expires"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,r.jsx)(j,{token:e,onViewDetails:s,onDeleteToken:m,isDeleting:x.has(e.id),formatTokenForDisplay:i,formatDate:l,getDaysUntilExpiry:c,isTokenExpired:o},e.id))})]})}),0===t.length&&(0,r.jsx)(k,{hasFilters:d})]})}var N=s(47190);function A(e){let{isOpen:t,onClose:s,onGenerate:n,isGenerating:i}=e,[l,c]=(0,a.useState)(100),[o,d]=(0,a.useState)(""),x=async e=>{if(e.preventDefault(),o.trim())try{await n(l,o),c(100),d("")}catch(e){}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Generate New Token"}),(0,r.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credits"}),(0,r.jsx)("input",{type:"number",value:l,onChange:e=>c(parseInt(e.target.value)||0),min:"1",max:"10000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:i,required:!0}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the number of credits (1-10,000)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),rows:3,placeholder:"Enter token description...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",disabled:i,required:!0,maxLength:500}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[o.length,"/500 characters"]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{i||(c(100),d(""),s())},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",disabled:i,children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:i||!o.trim()||l<1,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[i&&(0,r.jsx)(N.A,{className:"w-4 h-4 animate-spin"}),i?"Generating...":"Generate Token"]})]})]})]})})}):null}var T=s(72786),D=s(58227);function S(e){let{isOpen:t,onClose:s,token:n,onCopyToken:i}=e,[l,c]=a.useState(!1),o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=async()=>{if(n)try{await navigator.clipboard.writeText(n.token),c(!0),null==i||i(n.token),setTimeout(()=>c(!1),2e3)}catch(e){console.error("Failed to copy token:",e)}};if(!t||!n)return null;let g=n.isUsed?{icon:(0,r.jsx)(x.A,{className:"w-3 h-3 mr-1"}),text:"Used",className:"bg-green-100 text-green-800"}:new Date(n.expiresAt)<new Date?{icon:(0,r.jsx)(h.A,{className:"w-3 h-3 mr-1"}),text:"Expired",className:"bg-red-100 text-red-800"}:{icon:(0,r.jsx)(u.A,{className:"w-3 h-3 mr-1"}),text:"Unused",className:"bg-yellow-100 text-yellow-800"},y=(e=>{let t=new Date(e),s=new Date;return Math.ceil((t.getTime()-s.getTime())/864e5)})(n.expiresAt);return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[85vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 flex-shrink-0",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Token Details"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)(h.A,{className:"w-5 h-5"})})]}),(0,r.jsx)("div",{className:"flex-1 px-6 py-4 min-h-0",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Token"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("code",{className:"text-sm font-mono text-gray-900 bg-gray-100 px-2 py-1.5 rounded-md flex-1 break-all",children:n.token}),(0,r.jsx)("button",{onClick:m,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors bg-gray-100 rounded-md hover:bg-gray-200 flex-shrink-0",title:"Copy token",children:l?(0,r.jsx)(T.A,{className:"w-3.5 h-3.5 text-green-600"}):(0,r.jsx)(D.A,{className:"w-3.5 h-3.5"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Credits"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 text-blue-500"}),(0,r.jsx)("span",{className:"text-xl font-bold text-blue-600",children:n.credits.toLocaleString()})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ".concat(g.className),children:[g.icon,g.text]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Created By"}),(0,r.jsx)("div",{className:"text-sm text-gray-900 font-medium",children:n.createdBy})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Created At"}),(0,r.jsx)("div",{className:"text-sm text-gray-900",children:o(n.createdAt)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expires At"}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"text-sm text-gray-900",children:o(n.expiresAt)}),(0,r.jsx)("div",{className:"text-xs mt-0.5 font-medium ".concat(y<7?"text-red-600":y<30?"text-orange-600":"text-gray-500"),children:y>0?"".concat(y," days remaining"):"Expired ".concat(Math.abs(y)," days ago")})]})]})]}),n.isUsed&&(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,r.jsxs)("h4",{className:"text-xs font-medium text-green-800 mb-2 flex items-center gap-1.5",children:[(0,r.jsx)(x.A,{className:"w-3.5 h-3.5"}),"Usage Information"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-green-700 mb-0.5",children:"Used By"}),(0,r.jsx)("div",{className:"text-sm text-green-900 font-medium",children:n.usedBy||"N/A"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-green-700 mb-0.5",children:"Used At"}),(0,r.jsx)("div",{className:"text-sm text-green-900",children:n.usedAt?o(n.usedAt):"N/A"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("div",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-lg border",children:n.description||(0,r.jsx)("span",{className:"text-gray-500 italic",children:"No description provided"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Token ID"}),(0,r.jsx)("code",{className:"text-xs font-mono text-gray-600 bg-gray-100 px-2 py-1 rounded break-all",children:n.id})]})]})}),(0,r.jsx)("div",{className:"border-t border-gray-100 px-6 py-3 bg-gray-50 rounded-b-xl flex-shrink-0",children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:m,className:"flex-1 px-4 py-2 text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors flex items-center justify-center gap-2 font-medium border border-blue-200",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.A,{className:"w-4 h-4"}),"Copied!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.A,{className:"w-4 h-4"}),"Copy Token"]})}),(0,r.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Close"})]})})]})})}var U=s(40553),C=s(19258);function E(e){let{title:t,message:s,onDismiss:a,onRetry:n,variant:i="error",retryText:l="Try Again",isRetrying:c=!1}=e,o={error:{container:"bg-red-50 border-red-200",icon:"text-red-600",title:"text-red-800",message:"text-red-700",button:"text-red-600 hover:text-red-800"},warning:{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-600",title:"text-yellow-800",message:"text-yellow-700",button:"text-yellow-600 hover:text-yellow-800"},info:{container:"bg-blue-50 border-blue-200",icon:"text-blue-600",title:"text-blue-800",message:"text-blue-700",button:"text-blue-600 hover:text-blue-800"}}[i];return(0,r.jsx)("div",{className:"border rounded-lg p-4 ".concat(o.container),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(U.A,{className:"w-5 h-5 ".concat(o.icon)})}),(0,r.jsxs)("div",{className:"ml-3 flex-1",children:[t&&(0,r.jsx)("h3",{className:"text-sm font-medium ".concat(o.title," mb-1"),children:t}),(0,r.jsx)("div",{className:"text-sm ".concat(o.message),children:s}),n&&(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("button",{onClick:n,disabled:c,className:"inline-flex items-center gap-2 text-sm font-medium ".concat(o.button," hover:underline disabled:opacity-50 disabled:cursor-not-allowed"),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.A,{className:"w-4 h-4 animate-spin"}),"Retrying..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.A,{className:"w-4 h-4"}),l]})})})]}),a&&(0,r.jsx)("div",{className:"ml-auto pl-3",children:(0,r.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,r.jsxs)("button",{onClick:a,className:"inline-flex rounded-md p-1.5 ".concat(o.button," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-red-50 focus:ring-red-600"),children:[(0,r.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,r.jsx)(C.A,{className:"w-5 h-5"})]})})})]})})}var F=s(7029),M=s(37790);function L(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[l,c]=(0,a.useState)(null),[d,x]=(0,a.useState)(!1),[u,m]=(0,a.useState)(""),[h,g]=(0,a.useState)("all"),[y,b]=(0,a.useState)("createdAt"),[f,j]=(0,a.useState)("desc"),[k,T]=(0,a.useState)(!1),[D,U]=(0,a.useState)(!1),[C,L]=(0,a.useState)(null),R=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=e=>w.K.isTokenExpired(e),q=e=>({id:e.id,token:e.token,credits:e.credits,createdBy:e.createdBy,createdAt:e.createdAt,expiresAt:e.expiresAt,isUsed:e.isUsed,usedBy:e.usedBy,usedAt:e.usedAt,description:e.description}),_=async()=>{try{n(!0),c(null);let e=(await w.K.getAllTokens()).tokens.map(q);t(e)}catch(s){let e=s instanceof Error?s.message:"Failed to load tokens. Please try again.";c(e),console.error("Error loading tokens:",s),(e.includes("Authentication")||e.includes("log in"))&&t([])}finally{n(!1)}},O=async()=>{try{n(!0),c(null);let e=(await w.K.getMyTokens()).tokens.map(q);t(e)}catch(e){c(e instanceof Error?e.message:"Failed to load your tokens. Please try again."),console.error("Error loading my tokens:",e)}finally{n(!1)}},P=async(e,s)=>{try{x(!0),c(null);let r=await w.K.generateToken(e,s),a={id:"token-".concat(Date.now()),token:r.token,credits:r.credits,createdBy:"current-user",createdAt:new Date().toISOString(),expiresAt:r.expiresAt,isUsed:!1,description:r.description};t(e=>[a,...e]),T(!1),setTimeout(_,500)}catch(e){c(e instanceof Error?e.message:"Failed to generate token. Please try again."),console.error("Error generating token:",e)}finally{x(!1)}},Q=async e=>{try{await navigator.clipboard.writeText(e),console.log("Token copied:",w.K.formatTokenForDisplay(e))}catch(e){console.error("Failed to copy token:",e)}},G=(0,a.useMemo)(()=>{let t=e.filter(e=>!!(""===u||e.token.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase())||e.createdBy.toLowerCase().includes(u.toLowerCase()))&&("used"===h?e.isUsed:"unused"!==h||!e.isUsed&&!B(e.expiresAt)));return t.sort((e,t)=>{let s,r;switch(y){case"createdAt":s=new Date(e.createdAt).getTime(),r=new Date(t.createdAt).getTime();break;case"credits":s=e.credits,r=t.credits;break;case"expiresAt":s=new Date(e.expiresAt).getTime(),r=new Date(t.expiresAt).getTime();break;default:return 0}return(s-r)*("asc"===f?1:-1)}),t},[e,u,h,y,f]),I=(0,a.useMemo)(()=>{let t=e.filter(e=>e.isUsed),s=e.filter(e=>!e.isUsed&&!B(e.expiresAt));return{total:e.length,used:t.length,unused:s.length,totalCredits:e.reduce((e,t)=>e+t.credits,0),usedCredits:t.reduce((e,t)=>e+t.credits,0),availableCredits:s.reduce((e,t)=>e+t.credits,0)}},[e]),K=async()=>{try{w.K.refreshAuth(),await _()}catch(e){console.error("Auth refresh failed:",e)}};(0,a.useEffect)(()=>{_()},[]);let z=""!==u||"all"!==h;return(0,r.jsxs)(M.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-8 pb-12",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-extrabold tracking-tight text-admin-text-main flex items-center gap-3",children:"Credit Management"}),(0,r.jsx)("p",{className:"text-admin-text-muted mt-1 font-medium",children:"Generate and monitor API credit tokens"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:_,className:"px-4 py-2.5 bg-white border border-admin-border rounded-xl text-sm font-bold text-admin-text-main hover:bg-slate-50 hover:border-admin-primary/30 active:scale-95 transition-all flex items-center gap-2",disabled:s,children:[(0,r.jsx)(N.A,{className:"w-4 h-4 ".concat(s?"animate-spin":"")}),"Sync Tokens"]}),(0,r.jsxs)("button",{onClick:O,className:"px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl text-sm font-bold hover:bg-slate-200 active:scale-95 transition-all flex items-center gap-2",disabled:s,children:[(0,r.jsx)(F.A,{className:"w-4 h-4"}),"My Tokens"]}),(0,r.jsxs)("button",{onClick:()=>T(!0),className:"px-4 py-2.5 bg-admin-primary text-white rounded-xl text-sm font-bold shadow-md shadow-admin-primary/20 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"w-4 h-4"}),"New Token"]})]})]}),l&&(0,r.jsx)(E,{message:l,onDismiss:()=>c(null),onRetry:l.includes("Authentication")?K:_,retryText:l.includes("Authentication")?"Login Again":"Reload Tokens"}),s?(0,r.jsxs)("div",{className:"space-y-8 animate-pulse",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,t)=>(0,r.jsx)("div",{className:"bg-white p-6 rounded-2xl border border-admin-border h-32 shadow-sm"},t))}),(0,r.jsx)("div",{className:"bg-white rounded-2xl border border-admin-border h-96 shadow-sm"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{stats:I}),(0,r.jsxs)("div",{className:"bg-white rounded-3xl border border-admin-border shadow-sm overflow-hidden mt-8",children:[(0,r.jsx)(o,{searchTerm:u,setSearchTerm:m,filterStatus:h,setFilterStatus:g,sortBy:y,setSortBy:b,sortOrder:f,setSortOrder:j,onExport:()=>{try{let e=["Token,Credits,Status,Created By,Created,Expires,Used By,Used At,Description",...G.map(e=>{let t=e.isUsed?"Used":B(e.expiresAt)?"Expired":"Unused";return'"'.concat(e.token,'",').concat(e.credits,',"').concat(t,'","').concat(e.createdBy,'","').concat(R(e.createdAt),'","').concat(R(e.expiresAt),'","').concat(e.usedBy||"",'","').concat(e.usedAt?R(e.usedAt):"",'","').concat(e.description,'"')})].join("\n"),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="tokens-export-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s)}catch(e){c("Failed to export tokens. Please try again."),console.error("Error exporting tokens:",e)}},onGenerateToken:()=>T(!0)}),(0,r.jsx)(v,{tokens:G,onViewDetails:e=>{L(e),U(!0)},onTokenDeleted:()=>{"my-tokens"===h?O():_()},formatTokenForDisplay:e=>w.K.formatTokenForDisplay(e),formatDate:R,getDaysUntilExpiry:e=>w.K.getDaysUntilExpiry(e),isTokenExpired:B,hasFilters:z})]}),(0,r.jsx)(A,{isOpen:k,onClose:()=>T(!1),onGenerate:P,isGenerating:d}),(0,r.jsx)(S,{isOpen:D,onClose:()=>U(!1),token:C,onCopyToken:Q})]})]})}},87980:(e,t,s)=>{Promise.resolve().then(s.bind(s,76218))},89447:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(94853).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[3778,5789,6020,7358],()=>t(87980)),_N_E=e.O()}]);