exports.id=153,exports.ids=[153],exports.modules={3530:(e,t,s)=>{Promise.resolve().then(s.bind(s,46027))},42350:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(44789),a=s(52083),n=s(81436);async function i({children:e}){let{getUser:t,getRoles:s}=(0,a.nV)(),i=await t(),o=await s();return i||(0,n.redirect)("/api/auth/login"),o?.some(e=>"admin"===e.key)||(0,n.redirect)("/unauthorized"),(0,r.jsx)(r.Fragment,{children:e})}var o=s(94481),l=s(27144),d=s(46525),h=s(46035),c=s(38449);function u({user:e}){return(0,r.jsx)("header",{className:"bg-white/80 backdrop-blur-md border-b border-admin-border sticky top-0 z-30",children:(0,r.jsxs)("div",{className:"px-4 h-16 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-4 flex-1",children:(0,r.jsxs)("div",{className:"relative group max-w-md hidden md:block",children:[(0,r.jsx)(l.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-admin-text-muted group-focus-within:text-admin-primary transition-colors"}),(0,r.jsx)("input",{type:"text",placeholder:"Search something...",className:"bg-slate-50 border-none rounded-xl pl-10 pr-4 py-2 text-sm w-64 focus:ring-2 focus:ring-admin-primary/20 focus:bg-white transition-all outline-none"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,r.jsxs)("button",{className:"p-2 text-admin-text-muted hover:text-admin-primary hover:bg-slate-50 rounded-xl transition-all relative",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"absolute top-2 right-2.5 w-2 h-2 bg-red-500 rounded-full border-2 border-white"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-admin-border mx-1"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,r.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,r.jsx)("p",{className:"text-sm font-semibold leading-none",children:e.given_name||"Admin"}),(0,r.jsx)("p",{className:"text-[10px] text-admin-text-muted font-medium mt-1",children:e.email})]}),(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsx)("div",{className:"w-9 h-9 bg-slate-100 rounded-xl flex items-center justify-center border border-admin-border overflow-hidden ring-2 ring-transparent group-hover:ring-admin-primary/20 transition-all cursor-pointer",children:e.picture?(0,r.jsx)("img",{src:e.picture,alt:"profile",className:"w-full h-full object-cover"}):(0,r.jsx)(h.A,{className:"h-5 w-5 text-admin-text-muted"})}),(0,r.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-admin-border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right scale-95 group-hover:scale-100 py-1 overflow-hidden",children:[(0,r.jsxs)(o.pn,{postLogoutRedirectURL:"/",className:"flex items-center gap-2 px-4 py-2.5 text-sm text-slate-700 hover:bg-slate-50 transition-colors",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),"My Profile"]}),(0,r.jsx)("div",{className:"h-px bg-admin-border my-1"}),(0,r.jsxs)(o.pn,{postLogoutRedirectURL:"/",className:"flex items-center gap-2 px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 transition-colors font-medium",children:[(0,r.jsx)(c.A,{className:"h-4 w-4"}),"Sign Out"]})]})]})]})]})]})})}var m=s(68897);async function x({children:e}){let{getUser:t}=(0,a.nV)(),s=await t();return(0,r.jsx)("html",{lang:"en",className:"h-full",children:(0,r.jsx)("body",{className:"h-full bg-admin-bg selection:bg-admin-primary/10",children:(0,r.jsx)(i,{children:(0,r.jsxs)("div",{className:"flex h-full min-h-screen",children:[(0,r.jsx)(m.default,{}),(0,r.jsxs)("div",{className:"flex flex-col flex-1 min-w-0",children:[(0,r.jsx)(u,{user:s}),(0,r.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto h-full",children:e})})]})]})})})})}s(56422)},46027:(e,t,s)=>{"use strict";s.d(t,{default:()=>g});var r=s(21551),a=s(534),n=s.n(a),i=s(31965),o=s(91025),l=s(1480),d=s(12018),h=s(58243),c=s(95763),u=s(80112),m=s(95863);let x=[{name:"Dashboard",href:"/admin",icon:o.A},{name:"Users",href:"/admin/users",icon:l.A},{name:"Credits",href:"/admin/credits",icon:d.A},{name:"Services",href:"/admin/services",icon:h.A}];function g(){let e=(0,i.usePathname)();return(0,r.jsxs)("aside",{className:"hidden lg:flex w-72 flex-col bg-white border-r border-admin-border transition-all duration-300",children:[(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3 px-2",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-admin-primary rounded-xl flex items-center justify-center shadow-lg shadow-admin-primary/20",children:(0,r.jsx)(c.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold tracking-tight",children:"Automica"}),(0,r.jsx)("p",{className:"text-xs text-admin-text-muted font-medium",children:"Admin Console"})]})]})}),(0,r.jsxs)("nav",{className:"flex-1 px-4 space-y-1.5 overflow-y-auto pt-4",children:[(0,r.jsx)("p",{className:"px-4 text-[10px] font-bold text-admin-text-muted uppercase tracking-wider mb-2",children:"Main Menu"}),x.map(t=>{let s=e===t.href;return(0,r.jsxs)(n(),{href:t.href,className:`
                group flex items-center justify-between px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200
                ${s?"bg-admin-primary text-white shadow-md shadow-admin-primary/25":"text-admin-text-muted hover:bg-slate-50 hover:text-admin-text-main"}
              `,children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(t.icon,{className:`mr-3 h-5 w-5 transition-colors ${s?"text-white":"text-admin-text-muted group-hover:text-admin-primary"}`}),t.name]}),s&&(0,r.jsx)(u.A,{className:"h-4 w-4 opacity-70"})]},t.name)})]}),(0,r.jsx)("div",{className:"p-4 mt-auto border-t border-admin-border",children:(0,r.jsxs)(n(),{href:"/",className:"flex items-center px-4 py-3 text-sm font-medium text-admin-text-muted rounded-xl hover:bg-slate-50 hover:text-admin-text-main transition-all duration-200",children:[(0,r.jsx)(m.A,{className:"mr-3 h-5 w-5"}),"Back to Site"]})})]})}},47315:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2796,23)),Promise.resolve().then(s.t.bind(s,47514,23)),Promise.resolve().then(s.t.bind(s,44858,23)),Promise.resolve().then(s.t.bind(s,7893,23)),Promise.resolve().then(s.t.bind(s,83825,23)),Promise.resolve().then(s.t.bind(s,169,23)),Promise.resolve().then(s.t.bind(s,45889,23)),Promise.resolve().then(s.t.bind(s,94235,23))},56422:()=>{},68897:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(55547).registerClientReference)(function(){throw Error("Attempted to call the default export of \"X:\\\\Web Dev\\\\Automica\\\\frontend\\\\app\\\\(admin)\\\\components\\\\AdminSidebar.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"X:\\Web Dev\\Automica\\frontend\\app\\(admin)\\components\\AdminSidebar.tsx","default")},84267:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,5674,23)),Promise.resolve().then(s.t.bind(s,1364,23)),Promise.resolve().then(s.t.bind(s,91432,23)),Promise.resolve().then(s.t.bind(s,11939,23)),Promise.resolve().then(s.t.bind(s,52067,23)),Promise.resolve().then(s.t.bind(s,27547,23)),Promise.resolve().then(s.t.bind(s,12171,23)),Promise.resolve().then(s.t.bind(s,37813,23))},85378:(e,t,s)=>{Promise.resolve().then(s.bind(s,68897))},87182:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});class r{constructor(){this.authToken=null,this.tokenExpiry=null,this.baseUrl="https://dev.automica.ai/go/api/v1"}async getAuthToken(){if(this.authToken&&this.tokenExpiry&&Date.now()<this.tokenExpiry-3e5)return this.authToken;try{let e=await fetch("/api/auth",{credentials:"include"});if(!e.ok)throw Error(`Auth failed: ${e.status}`);let{accessToken:t,expiresIn:s}=await e.json();return this.authToken=t,this.tokenExpiry=Date.now()+1e3*s,t}catch(e){throw this.clearAuth(),Error("Authentication failed. Please log in again.")}}clearAuth(){this.authToken=null,this.tokenExpiry=null}buildQueryString(e){let t=Object.entries(e).filter(([e,t])=>null!=t&&""!==t);if(0===t.length)return"";let s=t.map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");return`?${s}`}async makeAuthenticatedRequest(e,t={}){let s=await this.getAuthToken(),r=await fetch(`${this.baseUrl}${e}`,{...t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,...t.headers}});if(!r.ok){if(401===r.status)throw this.clearAuth(),Error("Authentication expired. Please log in again.");let e=await r.text();throw Error(`API Error (${r.status}): ${e}`)}return r.json()}async generateToken(e,t){return this.makeAuthenticatedRequest("/tokens/generate",{method:"POST",body:JSON.stringify({credits:e,description:t})})}async deleteToken(e){return this.makeAuthenticatedRequest(`/tokens/${e}`,{method:"DELETE"})}async getMyTokens(){return this.makeAuthenticatedRequest("/tokens/my-tokens")}async getAllTokens(){return this.makeAuthenticatedRequest("/tokens/all")}async getUsedTokens(){return this.makeAuthenticatedRequest("/tokens/used")}async getUnusedTokens(){return this.makeAuthenticatedRequest("/tokens/unused")}async getAllUsers(){return this.makeAuthenticatedRequest("/admin/users")}async getUserById(e){return this.makeAuthenticatedRequest(`/admin/users/${e}`)}async getUserStats(){return this.makeAuthenticatedRequest("/admin/users/stats")}async getUserActivity(e){return this.makeAuthenticatedRequest(`/admin/users/${e}/activity`)}async getUserCredits(e){return this.makeAuthenticatedRequest(`/admin/users/${e}/credits`)}async getGlobalUsageStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest(`/admin/usage/global${t}`)}async getUserUsageStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest(`/admin/usage/users${t}`)}async getServiceUserStats(e){let t=e?this.buildQueryString(e):"";return this.makeAuthenticatedRequest(`/admin/usage/services${t}`)}async getUserUsageHistory(e,t){let s=t?this.buildQueryString(t):"";return this.makeAuthenticatedRequest(`/admin/usage/user/${e}/history${s}`)}async getServiceUsageHistory(e,t){let s=t?this.buildQueryString(t):"";return this.makeAuthenticatedRequest(`/admin/usage/service/${e}/history${s}`)}isAuthenticated(){return!!(this.authToken&&this.tokenExpiry&&Date.now()<this.tokenExpiry)}getTokenExpiry(){return this.tokenExpiry}refreshAuth(){this.clearAuth()}async getTokenStats(){try{let[e,t,s,r]=await Promise.all([this.getAllTokens(),this.getUsedTokens(),this.getUnusedTokens(),this.getMyTokens()]);return{total:e.count||e.tokens.length,used:t.count||t.tokens.length,unused:s.count||s.tokens.length,myTokens:r.count||r.tokens.length}}catch(e){throw Error(`Failed to fetch token statistics: ${e}`)}}async getDashboardStats(){try{let[e,t]=await Promise.all([this.getTokenStats(),this.getUserStats()]);return{tokenStats:e,userStats:t.stats}}catch(e){throw Error(`Failed to fetch dashboard statistics: ${e}`)}}async getUsageAnalytics(e){try{let[t,s,r]=await Promise.all([this.getGlobalUsageStats(e),this.getUserUsageStats(e),this.getServiceUserStats(e)]);return{globalStats:t,userStats:s,serviceStats:r}}catch(e){throw Error(`Failed to fetch usage analytics: ${e}`)}}async getTopServicesByUsage(e){try{return(await this.getGlobalUsageStats(e)).stats.sort((e,t)=>t.total_calls-e.total_calls)}catch(e){throw Error(`Failed to fetch top services: ${e}`)}}async getTopUsersByUsage(e){try{return(await this.getUserUsageStats(e)).stats.sort((e,t)=>t.total_calls-e.total_calls)}catch(e){throw Error(`Failed to fetch top users: ${e}`)}}isValidTokenFormat(e){return/^TK_[a-zA-Z0-9]{33}$/.test(e)}formatTokenForDisplay(e){return!e||e.length<10?e:`${e.substring(0,8)}...${e.substring(e.length-6)}`}getDaysUntilExpiry(e){let t=new Date(e),s=new Date;return Math.ceil((t.getTime()-s.getTime())/864e5)}isTokenExpired(e){return new Date(e)<new Date}formatUserRole(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}isUserRecentlyActive(e){return!!e&&new Date(e)>new Date(Date.now()-2592e6)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatDateForQuery(e){return e.toISOString().split("T")[0]}calculateSuccessRate(e,t){return 0===t?0:Math.round(e/t*1e4)/100}formatServiceName(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}getDateRangePresets(){let e=new Date,t=this.formatDateForQuery(e),s=new Date(e);s.setDate(s.getDate()-1);let r=new Date(e);r.setDate(r.getDate()-7);let a=new Date(e);a.setDate(a.getDate()-30);let n=new Date(e.getFullYear(),e.getMonth(),1),i=new Date(e.getFullYear(),e.getMonth()-1,1),o=new Date(e.getFullYear(),e.getMonth(),0);return{today:{start_date:t,end_date:t},yesterday:{start_date:this.formatDateForQuery(s),end_date:this.formatDateForQuery(s)},last7Days:{start_date:this.formatDateForQuery(r),end_date:t},last30Days:{start_date:this.formatDateForQuery(a),end_date:t},thisMonth:{start_date:this.formatDateForQuery(n),end_date:t},lastMonth:{start_date:this.formatDateForQuery(i),end_date:this.formatDateForQuery(o)}}}}let a=new r}};